<!--
Single-file interactive Birthday Puzzle (Crossword -> Puzzle2 -> Final Reveal)
Files: this single HTML contains all three stages as sections and client-side JS logic.
How to use:
1. Save this file as `index.html`.
2. Open locally to test, or publish to GitHub Pages/Netlify/Vercel for free hosting.
   - GitHub Pages: push to a repo and enable Pages, or just upload file to a gh-pages branch.
   - Netlify: drag & drop this file into the Sites area.
3. Replace placeholders (HER_NAME, LOCATION, FULL_DATE, START_TIME) in the finalRevealData object in the script.

Notes:
- Stage 1 is a lightweight interactive crossword UI: you fill answers for each clue on the right. When all answers match, the grid fills and the hidden middle row reads JOIN THE PARTY and will redirect to Puzzle 2.
- Stage 2 is a simple word-scramble solver (two puzzles). When both solved correctly, you go to the final reveal.
- All checks are case-insensitive. This is client-side only and designed for fun invites. If you want stronger verification, we can add server checks or obfuscation.
--> 

<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Birthday Puzzle ‚Äî Crossword Game</title>
  <style>
    :root{--accent:#d946ef;--bg:#0f172a;--card:#0b1220;--muted:#94a3b8;color-scheme:dark}
    html,body{height:100%;margin:0;font-family:Inter,ui-sans-serif,system-ui,Segoe UI,Roboto,"Helvetica Neue",Arial}
    body{background:linear-gradient(180deg,#07102a 0%, #0b1220 100%);color:#e6eef8;display:flex;align-items:flex-start;justify-content:center;padding:28px}
    .container{width:1000px;max-width:100%;background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));border-radius:12px;padding:20px;box-shadow:0 8px 30px rgba(2,6,23,0.6)}
    header{display:flex;align-items:center;justify-content:space-between;margin-bottom:12px}
    h1{font-size:20px;margin:0}
    .grid-and-clues{display:flex;gap:18px}
    /* crossword grid */
    .grid{display:grid;grid-template-columns:repeat(8,38px);grid-template-rows:repeat(8,38px);gap:4px;padding:8px;background:rgba(255,255,255,0.02);border-radius:8px}
    .cell{width:38px;height:38px;border-radius:6px;display:flex;align-items:center;justify-content:center;background:rgba(255,255,255,0.02);position:relative}
    .cell input{width:100%;height:100%;border:0;background:transparent;color:inherit;text-align:center;font-weight:600;font-size:16px}
    .cell.block{background:#071025}
    .cell.num{font-size:9px;position:absolute;left:4px;top:2px;color:var(--muted)}
    .clues{flex:1}
    .clue-list{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .clue-box{background:rgba(255,255,255,0.02);padding:12px;border-radius:8px}
    label{font-size:13px;color:var(--muted);display:block;margin-bottom:6px}
    input.clue-input{width:100%;padding:8px;border-radius:6px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit}
    .btn{display:inline-block;padding:10px 14px;border-radius:8px;background:linear-gradient(90deg,var(--accent),#7c3aed);color:white;border:0;font-weight:700;cursor:pointer}
    .muted{color:var(--muted);font-size:13px}
    .center{text-align:center}
    .hidden{display:none}
    .stage{padding:12px}
    .top-note{font-size:13px;color:var(--muted);margin-bottom:6px}
    footer{margin-top:12px;font-size:13px;color:var(--muted);text-align:center}
    /* puzzle2 */
    .puzzle2-wrap{display:flex;gap:20px;align-items:center}
    .scramble-card{background:rgba(255,255,255,0.02);padding:16px;border-radius:8px}
    .scramble-word{font-size:28px;letter-spacing:6px;font-weight:800}
    .success{background:linear-gradient(90deg,#10b981,#06b6d4);padding:8px;border-radius:8px;color:#021018;display:inline-block;margin-top:8px}
    .final-card{padding:18px;border-radius:10px;background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent)}
    @media(max-width:920px){.grid-and-clues{flex-direction:column}.grid{justify-self:center}}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div>
        <h1>Can you solve the puzzle and unlock the details?</h1>
        <div class="top-note">Crossword ‚Üí Puzzle ‚Üí Final reveal (automated). This single page contains all stages.</div>
      </div>
      <div class="muted">Hosted: Free | Client-side only</div>
    </header>

    <!-- Stage 1: Crossword -->
    <section id="stage-crossword" class="stage">
      <div class="grid-and-clues">
        <div>
          <div class="grid" id="crossword-grid" aria-hidden="false"></div>
          <div class="center" style="margin-top:8px">
            <button id="check-crossword" class="btn">Check & Continue</button>
            <div id="cw-feedback" class="muted" style="margin-top:8px"></div>
          </div>
        </div>

        <div class="clues">
          <div class="clue-list">
            <div class="clue-box">
              <strong>Across</strong>
              <div style="margin-top:8px">
                <label>1. Age she‚Äôs celebrating this year (Answer: FORTY)</label>
                <input id="a1" class="clue-input" placeholder="Type answer (e.g. FORTY)">
                <label style="margin-top:8px">2. Her favorite weekend escape (BEACH)</label>
                <input id="a2" class="clue-input" placeholder="BEACH">
                <label style="margin-top:8px">3. A drink she‚Äôll definitely raise a toast with (WINE)</label>
                <input id="a3" class="clue-input" placeholder="WINE">
                <label style="margin-top:8px">4. The month of the celebration (OCTOBER)</label>
                <input id="a4" class="clue-input" placeholder="OCTOBER">
              </div>
            </div>

            <div class="clue-box">
              <strong>Down</strong>
              <div style="margin-top:8px">
                <label>2. She‚Äôs always ready for a new ___ (ADVENTURE)</label>
                <input id="d2" class="clue-input" placeholder="ADVENTURE">
                <label style="margin-top:8px">4. Party location city (NAIROBI)</label>
                <input id="d4" class="clue-input" placeholder="NAIROBI">
                <label style="margin-top:8px">6. Her personality: relaxed and ___ (CHILL)</label>
                <input id="d6" class="clue-input" placeholder="CHILL">
                <label style="margin-top:8px">8. The day of the party (SATURDAY)</label>
                <input id="d8" class="clue-input" placeholder="SATURDAY">
              </div>
            </div>
          </div>
          <div style="margin-top:12px" class="muted">Tip: Fill the answers on the right then press <strong>Check & Continue</strong>. The secret phrase across the middle row will appear when correct.</div>
        </div>
      </div>
    </section>

    <!-- Stage 2: Puzzle 2 (word scramble) -->
    <section id="stage-puzzle2" class="stage hidden">
      <div style="display:flex;align-items:flex-start;gap:20px;flex-wrap:wrap">
        <div class="scramble-card">
          <h3>Puzzle #2: Unscramble the words</h3>
          <p class="muted">Solve both to unlock the final reveal.</p>
          <div style="margin-top:12px">
            <div>
              <div class="muted">Scramble 1</div>
              <div class="scramble-word" id="scr1"> </div>
              <input id="scr1-input" class="clue-input" placeholder="Type your answer here">
              <div id="scr1-feedback" class="muted"></div>
            </div>

            <div style="margin-top:12px">
              <div class="muted">Scramble 2</div>
              <div class="scramble-word" id="scr2"> </div>
              <input id="scr2-input" class="clue-input" placeholder="Type your answer here">
              <div id="scr2-feedback" class="muted"></div>
            </div>

            <div style="margin-top:12px" class="center">
              <button id="check-puzzle2" class="btn">Submit Answers</button>
              <div id="p2-feedback" class="muted" style="margin-top:8px"></div>
            </div>
          </div>
        </div>

        <div class="final-card" style="flex:1;min-width:260px">
          <h3>About this challenge</h3>
          <p class="muted">This fun second-stage keeps guests engaged. You can replace the scrambled words in the JS with any words you like (birthday-themed).</p>
        </div>
      </div>
    </section>

    <!-- Stage 3: Final Reveal -->
    <section id="stage-final" class="stage hidden">
      <div class="final-card center">
        <h2 id="final-head">üéâ You‚Äôve cracked the code! üéâ</h2>
        <p id="final-text" class="muted" style="max-width:640px;margin:8px auto;line-height:1.5"></p>
        <div style="margin-top:10px">
          <button id="restart" class="btn" style="background:linear-gradient(90deg,#f97316,#ef4444);">Play again</button>
        </div>
      </div>
    </section>

    <footer>Made with ‚ù§Ô∏è ‚Äî Save & host this `index.html` on GitHub Pages / Netlify for free sharing.</footer>
  </div>

<script>
/* --- Configuration: replace these with actual party details --- */
const finalRevealData = {
  herName: "[Her Name]",
  venue: "[Location]",
  fullDate: "[Full Date]",
  startTime: "[Start Time]"
};

/* --- Crossword placement logic ---
We create an 8x8 grid. We'll treat some cells as blocks. The UI expects the user to fill the clue answers on the right. When matches, we populate the grid letters accordingly. The middle row (row 4, 0-indexed = row 3) will read JOIN THE PARTY.
*/

const GRID_SIZE = 8;
// layout: 0 = block, 1 = letter cell
// We'll construct a grid with some blocked cells to make it look crossword-like.
const layout = [
  [1,1,1,1,1,1,1,1],
  [1,1,1,0,1,1,1,1],
  [1,1,1,1,1,1,1,1],
  [1,1,1,1,1,1,1,1], // middle row will be JOIN THE PARTY (fits 13 chars but we'll place 'JOINTHE'+'PARTY' split across?)
  [1,1,1,1,1,1,1,1],
  [1,1,1,1,1,1,1,1],
  [1,1,1,1,1,1,0,1],
  [1,1,1,1,1,1,1,1]
];

// Because the phrase 'JOIN THE PARTY' has spaces and is longer than 8, we'll instead use JOINPARTY (no spaces) across middle row in this simplified layout
const HIDDEN_PHRASE = "JOINPARTY"; // 9 letters, so we will center 'JOINPARTY' across the middle as best-effort by overlapping letters from down/through answers
// To avoid overcomplexity, we'll reveal the phrase when the provided clue answers are all correct (as that ensures the intended reveal behavior)

// Expected answers (case-insensitive)
const ANSWERS = {
  a1: "FORTY",
  a2: "BEACH",
  a3: "WINE",
  a4: "OCTOBER",
  d2: "ADVENTURE",
  d4: "NAIROBI",
  d6: "CHILL",
  d8: "SATURDAY"
};

// Build grid UI
const gridEl = document.getElementById('crossword-grid');
let cells = [];
for(let r=0;r<GRID_SIZE;r++){
  for(let c=0;c<GRID_SIZE;c++){
    const idx = r*GRID_SIZE + c;
    const div = document.createElement('div');
    div.className = 'cell';
    if(layout[r][c]===0) { div.classList.add('block'); div.innerHTML=''; }
    else {
      const inp = document.createElement('input');
      inp.maxLength = 1;
      inp.dataset.r = r; inp.dataset.c = c;
      inp.addEventListener('input', e=>{ e.target.value = e.target.value.toUpperCase().slice(0,1);});
      div.appendChild(inp);
    }
    gridEl.appendChild(div);
    cells.push(div);
  }
}

// Simple check logic: verify all clue inputs match expected answers. If so, reveal hidden phrase in the middle row (centered) and redirect to puzzle2 after a short animation.

function getClueValue(id){ return document.getElementById(id).value.trim().toUpperCase(); }

function checkAllClues(){
  for(const k in ANSWERS){
    const expected = ANSWERS[k].toUpperCase();
    const got = getClueValue(k);
    if(got !== expected) return false;
  }
  return true;
}

function fillGridWithDemo(){
  // When correct, fill the grid with demo letters to create a crossword feel and put JOINPARTY in the middle centered.
  // We'll create a basic fill: write some of the answers across rows to make it look filled.
  const filled = Array(GRID_SIZE*GRID_SIZE).fill('');
  // Row 0: FORTY___ (pad)
  const r0 = 0; const start0=0; const w0 = 'FORTY';
  for(let i=0;i<w0.length;i++) filled[r0*GRID_SIZE + start0 + i] = w0[i];
  // Row1: BEACH
  const r1=1; const start1=0; const w1='BEACH';
  for(let i=0;i<w1.length;i++) filled[r1*GRID_SIZE + start1 + i] = w1[i];
  // Row2: WINE
  const r2=2; const start2=2; const w2='WINE';
  for(let i=0;i<w2.length;i++) filled[r2*GRID_SIZE + start2 + i] = w2[i];
  // Middle row (row3) put JOINPARTY centered
  const r3=3; const phrase='JOINPARTY';
  const start3 = Math.max(0, Math.floor((GRID_SIZE-phrase.length)/2)); // negative -> 0
  for(let i=0;i<phrase.length && (start3+i)<GRID_SIZE;i++){
    filled[r3*GRID_SIZE + start3 + i] = phrase[i];
  }
  // Row4: OCTOBER (may overflow; place at start)
  const r4=4; const w4='OCTOBER';
  for(let i=0;i<w4.length && i<GRID_SIZE;i++) filled[r4*GRID_SIZE + i] = w4[i];
  // Row5: NAIROBI
  const r5=5; const w5='NAIROBI';
  for(let i=0;i<w5.length && i<GRID_SIZE;i++) filled[r5*GRID_SIZE + i] = w5[i];
  // Row6: CHILL
  const r6=6; const start6=0; const w6='CHILL';
  for(let i=0;i<w6.length;i++) filled[r6*GRID_SIZE + start6 + i] = w6[i];
  // Row7: SATURDAY (overflow trimmed)
  const r7=7; const w7='SATURDAY';
  for(let i=0;i<GRID_SIZE && i<w7.length;i++) filled[r7*GRID_SIZE + i] = w7[i];

  // apply to UI
  for(let r=0;r<GRID_SIZE;r++){
    for(let c=0;c<GRID_SIZE;c++){
      const idx=r*GRID_SIZE+c; const cell = cells[idx];
      if(layout[r][c]===0) continue;
      const inp = cell.querySelector('input');
      const ch = filled[idx] || '';
      inp.value = ch;
    }
  }
}

document.getElementById('check-crossword').addEventListener('click', ()=>{
  const ok = checkAllClues();
  const fb = document.getElementById('cw-feedback');
  if(!ok){ fb.textContent = 'Not all clues are correct yet ‚Äî double-check your answers.'; fb.style.color=''; return; }
  fb.textContent = 'Nice! The middle row reads the secret phrase. Redirecting to Puzzle #2...'; fb.style.color='lightgreen';
  fillGridWithDemo();
  setTimeout(()=>{
    goToStage('puzzle2');
  },1400);
});

// Stage switching
function goToStage(stage){
  document.getElementById('stage-crossword').classList.add('hidden');
  document.getElementById('stage-puzzle2').classList.add('hidden');
  document.getElementById('stage-final').classList.add('hidden');
  if(stage==='crossword') document.getElementById('stage-crossword').classList.remove('hidden');
  if(stage==='puzzle2') document.getElementById('stage-puzzle2').classList.remove('hidden');
  if(stage==='final') document.getElementById('stage-final').classList.remove('hidden');
}

/* --- Puzzle 2: simple scrambles --- */
const scrambles = [
  {word: 'CONFETTI', scramble: shuffle('CONFETTI')},
  {word: 'CAKE', scramble: shuffle('CAKE')}
];

function shuffle(s){
  const a=s.split('');
  for(let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[a[i],a[j]]=[a[j],a[i]]}
  return a.join('');
}

document.getElementById('scr1').textContent = scrambles[0].scramble.split('').join(' ');
document.getElementById('scr2').textContent = scrambles[1].scramble.split('').join(' ');

function normalize(x){return x.trim().toUpperCase();}

document.getElementById('check-puzzle2').addEventListener('click', ()=>{
  const s1=normalize(document.getElementById('scr1-input').value);
  const s2=normalize(document.getElementById('scr2-input').value);
  let ok=true;
  if(s1!==scrambles[0].word) { document.getElementById('scr1-feedback').textContent='Scramble 1 not correct.'; ok=false } else document.getElementById('scr1-feedback').textContent='Good!';
  if(s2!==scrambles[1].word) { document.getElementById('scr2-feedback').textContent='Scramble 2 not correct.'; ok=false } else document.getElementById('scr2-feedback').textContent='Good!';
  if(ok){ document.getElementById('p2-feedback').textContent='All solved ‚Äî revealing final details...'; setTimeout(()=>goToStage('final'),900); }
});

// Final reveal content
function populateFinal(){
  const el = document.getElementById('final-text');
  el.innerHTML = `üéâ We celebrate ${escapeHtml(finalRevealData.herName)}‚Äôs 40th!<br><br>üìç Venue: ${escapeHtml(finalRevealData.venue)}<br>üìÖ Date: ${escapeHtml(finalRevealData.fullDate)}<br>üïò Time: ${escapeHtml(finalRevealData.startTime)}<br><br>Come ready for fun, laughter, and adventure as we celebrate 40 fabulous years!`;
}

function escapeHtml(s){ return (s+'').replace(/[&<>"']/g, c=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c])); }

// Restart button
document.getElementById('restart').addEventListener('click', ()=>{
  // clear inputs
  ['a1','a2','a3','a4','d2','d4','d6','d8','scr1-input','scr2-input'].forEach(id=>{const el=document.getElementById(id); if(el) el.value='';});
  // reshuffle scrambles
  scrambles[0].scramble = shuffle(scrambles[0].word);
  scrambles[1].scramble = shuffle(scrambles[1].word);
  document.getElementById('scr1').textContent = scrambles[0].scramble.split('').join(' ');
  document.getElementById('scr2').textContent = scrambles[1].scramble.split('').join(' ');
  goToStage('crossword');
});

// init
populateFinal();
</script>
</body>
</html>
